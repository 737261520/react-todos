{"version":3,"sources":["formatters.js"],"names":[],"mappings":"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","file":"formatters-compiled.js","sourcesContent":["var fs = require('fs');\nvar util = require('util');\n\nvar JS_TEMPLATE_PATH = __dirname + '/../../config.tpl.js';\nvar COFFEE_TEMPLATE_PATH = __dirname + '/../../config.tpl.coffee';\nvar JS_REQUIREJS_TEMPLATE_PATH = __dirname + '/../../requirejs.config.tpl.js';\nvar COFFEE_REQUIREJS_TEMPLATE_PATH = __dirname + '/../../requirejs.config.tpl.coffee';\nvar COFFEE_REGEXP = /\\.coffee$/;\nvar LIVE_TEMPLATE_PATH = __dirname + '/../../config.tpl.ls';\nvar LIVE_REGEXP = /\\.ls$/;\n\n\nvar isCoffeeFile = function(filename) {\n  return COFFEE_REGEXP.test(filename);\n};\n\nvar isLiveFile = function(filename) {\n  return LIVE_REGEXP.test(filename);\n};\n\nvar JavaScriptFormatter = function() {\n\n  var quote = function(value) {\n    return '\\'' + value + '\\'';\n  };\n\n  var quoteNonIncludedPattern = function(value) {\n    return util.format('{pattern: %s, included: false}', quote(value));\n  };\n\n  var pad = function(str, pad) {\n    return str.replace(/\\n/g, '\\n' + pad).replace(/\\s+$/gm, '');\n  };\n\n  var formatQuottedList = function(list) {\n    return list.map(quote).join(', ');\n  };\n\n  this.TEMPLATE_FILE_PATH = JS_TEMPLATE_PATH;\n  this.REQUIREJS_TEMPLATE_FILE = JS_REQUIREJS_TEMPLATE_PATH;\n\n  this.formatFiles = function(includedFiles, onlyServedFiles) {\n    var files = includedFiles.map(quote);\n\n    onlyServedFiles.forEach(function(onlyServedFile) {\n      files.push(quoteNonIncludedPattern(onlyServedFile));\n    });\n\n    files = files.map(function(file) {\n      return '\\n      ' + file;\n    });\n\n    return files.join(',');\n  };\n\n  this.formatPreprocessors = function(preprocessors) {\n    var lines = [];\n    Object.keys(preprocessors).forEach(function(pattern) {\n      lines.push('  ' + quote(pattern) + ': [' + formatQuottedList(preprocessors[pattern]) + ']');\n    });\n\n    return pad('{\\n' + lines.join(',\\n') + '\\n}', '    ');\n  };\n\n  this.formatFrameworks = formatQuottedList;\n\n  this.formatBrowsers = formatQuottedList;\n\n  this.formatAnswers = function(answers) {\n    return {\n      DATE: new Date(),\n      BASE_PATH: answers.basePath,\n      FRAMEWORKS: this.formatFrameworks(answers.frameworks),\n      FILES: this.formatFiles(answers.files, answers.onlyServedFiles),\n      EXCLUDE: this.formatFiles(answers.exclude, []),\n      AUTO_WATCH: answers.autoWatch ? 'true' : 'false',\n      BROWSERS: this.formatBrowsers(answers.browsers),\n      PREPROCESSORS: this.formatPreprocessors(answers.preprocessors)\n    };\n  };\n\n  this.generateConfigFile = function(answers) {\n    var template = fs.readFileSync(this.TEMPLATE_FILE_PATH).toString();\n    var replacements = this.formatAnswers(answers);\n\n    return template.replace(/%(.*)%/g, function(a, key) {\n      return replacements[key];\n    });\n  };\n\n  this.writeConfigFile = function(path, answers) {\n    fs.writeFileSync(path, this.generateConfigFile(answers));\n  };\n\n  this.generateRequirejsConfigFile = function() {\n    var template = fs.readFileSync(this.REQUIREJS_TEMPLATE_FILE).toString();\n    return template;\n  };\n\n  this.writeRequirejsConfigFile = function(path) {\n    fs.writeFileSync(path, this.generateRequirejsConfigFile());\n  };\n};\n\nvar CoffeeFormatter = function() {\n  JavaScriptFormatter.call(this);\n\n  this.TEMPLATE_FILE_PATH = COFFEE_TEMPLATE_PATH;\n  this.REQUIREJS_TEMPLATE_FILE = COFFEE_REQUIREJS_TEMPLATE_PATH;\n};\n\nvar LiveFormatter = function() {\n  JavaScriptFormatter.call(this);\n\n  this.TEMPLATE_FILE_PATH = LIVE_TEMPLATE_PATH;\n};\n\nexports.JavaScript = JavaScriptFormatter;\nexports.Coffee = CoffeeFormatter;\nexports.Live = LiveFormatter;\n\nexports.createForPath = function(path) {\n  if (isCoffeeFile(path)) {\n    return new CoffeeFormatter();\n  }\n\n  if (isLiveFile(path)) {\n    return new LiveFormatter();\n  }\n\n  return new JavaScriptFormatter();\n};\n"]}