{"version":3,"sources":["completion.js"],"names":[],"mappings":"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","file":"completion-compiled.js","sourcesContent":["var CUSTOM = [''];\nvar BOOLEAN = false;\n\nvar options = {\n  start: {\n    '--port': CUSTOM,\n    '--auto-watch': BOOLEAN,\n    '--no-auto-watch': BOOLEAN,\n    '--log-level': ['disable', 'debug', 'info', 'warn', 'error'],\n    '--colors': BOOLEAN,\n    '--no-colors': BOOLEAN,\n    '--reporters': ['dots', 'progress'],\n    '--no-reporters': BOOLEAN,\n    '--browsers': ['Chrome', 'ChromeCanary', 'Firefox', 'PhantomJS', 'Safari', 'Opera'],\n    '--no-browsers': BOOLEAN,\n    '--single-run': BOOLEAN,\n    '--no-single-run': BOOLEAN,\n    '--help': BOOLEAN\n  },\n  init: {\n    '--log-level': ['disable', 'debug', 'info', 'warn', 'error'],\n    '--colors': BOOLEAN,\n    '--no-colors': BOOLEAN,\n    '--help': BOOLEAN\n  },\n  run: {\n    '--no-refresh': BOOLEAN,\n    '--port': CUSTOM,\n    '--help': BOOLEAN\n  }\n};\n\nvar parseEnv = function(argv, env) {\n  var words = argv.slice(5);\n\n  return {\n    words: words,\n    count: parseInt(env.COMP_CWORD, 10),\n    last: words[words.length - 1],\n    prev: words[words.length - 2]\n  };\n};\n\nvar opositeWord = function(word) {\n  if (word.charAt(0) !== '-') {\n    return null;\n  }\n\n  return word.substr(0, 5) === '--no-' ? '--' + word.substr(5) : '--no-' + word.substr(2);\n};\n\nvar sendCompletionNoOptions = function() {};\n\nvar sendCompletion = function(possibleWords, env) {\n  var regexp = new RegExp('^' + env.last);\n  var filteredWords = possibleWords.filter(function(word) {\n    return regexp.test(word) && env.words.indexOf(word) === -1 &&\n        env.words.indexOf(opositeWord(word)) === -1;\n  });\n\n  if (!filteredWords.length) {\n    return sendCompletionNoOptions(env);\n  }\n\n  filteredWords.forEach(function(word) {\n    console.log(word);\n  });\n};\n\n\nvar glob = require('glob');\nvar globOpts = {\n  mark: true,\n  nocase: true\n};\n\nvar sendCompletionFiles = function(env) {\n  glob(env.last + '*', globOpts, function(err, files) {\n    if (files.length === 1 && files[0].charAt(files[0].length - 1) === '/') {\n      sendCompletionFiles({last: files[0]});\n    } else {\n      console.log(files.join('\\n'));\n    }\n  });\n};\n\nvar sendCompletionConfirmLast = function(env) {\n  console.log(env.last);\n};\n\nvar complete = function(env) {\n  if (env.count === 1) {\n    if (env.words[0].charAt(0) === '-') {\n      return sendCompletion(['--help', '--version'], env);\n    }\n\n    return sendCompletion(Object.keys(options), env);\n  }\n\n  if (env.count === 2 && env.words[1].charAt(0) !== '-') {\n    // complete files (probably karma.conf.js)\n    return sendCompletionFiles(env);\n  }\n\n  var cmdOptions = options[env.words[0]];\n  var previousOption = cmdOptions[env.prev];\n\n  if (!cmdOptions) {\n    // no completion, wrong command\n    return sendCompletionNoOptions();\n  }\n\n  if (previousOption === CUSTOM && env.last) {\n    // custom value with already filled something\n    return sendCompletionConfirmLast(env);\n  }\n\n  if (previousOption) {\n    // custom options\n    return sendCompletion(previousOption, env);\n  }\n\n  return sendCompletion(Object.keys(cmdOptions), env);\n};\n\n\nvar completion = function() {\n  if (process.argv[3] === '--') {\n    return complete(parseEnv(process.argv, process.env));\n  }\n\n  // just print out the karma-completion.sh\n  var fs = require('fs');\n  var path = require('path');\n\n  fs.readFile(path.resolve(__dirname, '../karma-completion.sh'), 'utf8', function(err, data) {\n    process.stdout.write(data);\n    process.stdout.on('error', function(error) {\n      // Darwin is a real dick sometimes.\n      //\n      // This is necessary because the \"source\" or \".\" program in\n      // bash on OS X closes its file argument before reading\n      // from it, meaning that you get exactly 1 write, which will\n      // work most of the time, and will always raise an EPIPE.\n      //\n      // Really, one should not be tossing away EPIPE errors, or any\n      // errors, so casually.  But, without this, `. <(karma completion)`\n      // can never ever work on OS X.\n      if (error.errno === 'EPIPE') {\n        error = null;\n      }\n    });\n  });\n};\n\n\n// PUBLIC API\nexports.completion = completion;\n\n// for testing\nexports.opositeWord = opositeWord;\nexports.sendCompletion = sendCompletion;\nexports.complete = complete;\n"]}