{"version":3,"sources":["browser_collection.js"],"names":[],"mappings":"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","file":"browser_collection-compiled.js","sourcesContent":["var EXECUTING = require('./browser').STATE_EXECUTING;\nvar Result = require('./browser_result');\n\nvar Collection = function(emitter, browsers) {\n  browsers = browsers || [];\n\n  this.add = function(browser) {\n    browsers.push(browser);\n    emitter.emit('browsers_change', this);\n  };\n\n  this.remove = function(browser) {\n    var index = browsers.indexOf(browser);\n\n    if (index === -1) {\n      return false;\n    }\n\n    browsers.splice(index, 1);\n    emitter.emit('browsers_change', this);\n\n    return true;\n  };\n\n  this.getById = function(browserId) {\n    for (var i = 0; i < browsers.length; i++) {\n      if (browsers[i].id === browserId) {\n        return browsers[i];\n      }\n    }\n\n    return null;\n  };\n\n  this.setAllToExecuting = function() {\n    browsers.forEach(function(browser) {\n      browser.state = EXECUTING;\n    });\n\n    emitter.emit('browsers_change', this);\n  };\n\n  this.areAllReady = function(nonReadyList) {\n    nonReadyList = nonReadyList || [];\n\n    browsers.forEach(function(browser) {\n      if (!browser.isReady()) {\n        nonReadyList.push(browser);\n      }\n    });\n\n    return nonReadyList.length === 0;\n  };\n\n  this.serialize = function() {\n    return browsers.map(function(browser) {\n      return browser.serialize();\n    });\n  };\n\n  this.getResults = function() {\n    var results = browsers.reduce(function(previous, current) {\n      previous.success += current.lastResult.success;\n      previous.failed += current.lastResult.failed;\n      previous.error = previous.error || current.lastResult.error;\n      previous.disconnected = previous.disconnected || current.lastResult.disconnected;\n      return previous;\n    }, {success: 0, failed: 0, error: false, disconnected: false, exitCode: 0});\n\n    // compute exit status code\n    results.exitCode = results.failed || results.error || results.disconnected ? 1 : 0;\n\n    return results;\n  };\n\n  // TODO(vojta): can we remove this? (we clear the results per browser in onBrowserStart)\n  this.clearResults = function() {\n    browsers.forEach(function(browser) {\n      browser.lastResult = new Result();\n    });\n  };\n\n  this.clone = function() {\n    return new Collection(emitter, browsers.slice());\n  };\n\n  // Array APIs\n  this.map = function(callback, context) {\n    return browsers.map(callback, context);\n  };\n\n  this.forEach = function(callback, context) {\n    return browsers.forEach(callback, context);\n  };\n\n  // this.length\n  Object.defineProperty(this, 'length', {\n    get: function() {\n      return browsers.length;\n    }\n  });\n};\nCollection.$inject = ['emitter'];\n\n\nmodule.exports = Collection;\n"]}