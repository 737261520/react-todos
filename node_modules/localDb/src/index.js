/**
 * Created by YikaJ on 15/6/10.
 */
'use strict';

class LocalDb{
    constructor(){
        if(!window.localStorage){
            throw new Error("Not supports localStorage");
        }

        if(localStorage.localDb){
            this.db = JSON.parse(localStorage.localDb);
        }else{
            this.db = {};
        }
    }

    getDb(){
        return this.db;
    }

    set(key, value){
        if(key){
            this.db[key] = value;

            return this._saveToLocalStorage();
        }

        throw new Error("set参数key不能为空");
    }

    get(key){
        if(key){
            let value = this.db[key];
            if(typeof value === 'undefined'){
                console.warn(key + "的值不存在");
            }
            return value;
        }

        throw new Error("get参数key不能为空");
    }

    clean(){
        this.db = {};
        this._saveToLocalStorage();
    }

    _saveToLocalStorage(){
        localStorage.localDb = JSON.stringify(this.getDb());
    }
}

window.LocalDb = LocalDb;